Description: <short summary of the patch>
 TODO: Put a short summary on the line above and replace this paragraph
 with a longer explanation of this change. Complete the meta-information
 with other relevant fields (see below for details). To make it easier, the
 information below has been extracted from the changelog. Adjust it or drop
 it.
 .
 ovideo (1-191) bionic; urgency=medium
 .
   * update with source
Author: bc <bc@bc-Type1ProductConfigId>

---
The information above should follow the Patch Tagging Guidelines, please
checkout https://dep.debian.net/deps/dep3/ to learn about the format. Here
are templates for supplementary fields that you might want to add:

Origin: (upstream|backport|vendor|other), (<patch-url>|commit:<commit-id>)
Bug: <upstream-bugtracker-url>
Bug-Debian: https://bugs.debian.org/<bugnumber>
Bug-Ubuntu: https://launchpad.net/bugs/<bugnumber>
Forwarded: (no|not-needed|<patch-forwarded-url>)
Applied-Upstream: <version>, (<commit-url>|commit:<commid-id>)
Reviewed-By: <name and email of someone who approved/reviewed the patch>
Last-Update: 2024-07-29

--- ovideo-1.orig/.github/workflows/rpm.yml
+++ ovideo-1/.github/workflows/rpm.yml
@@ -3,8 +3,8 @@ on:
   inputs:
    ppa:
     description: "ppa sufix"
-   unpublished:
-    description: "don't wait to publish, take from build page"
+   #unpublished:
+   # description: "don't wait to publish, take from build page"
 
 # A workflow run is made up of one or more jobs that can run sequentially or in parallel
 jobs:
@@ -15,40 +15,52 @@ jobs:
   # Steps represent a sequence of tasks that will be executed as part of the job
   steps:
    - uses: actions/checkout@v3
-   #Runs a set of commands using the runners shell
-   - name: Run a multi-line script
+   - name: get name version
      run: |
       #proj
       name=`cat debian/changelog | head -1 | grep -o ^[^\ ]*`
+      echo "name=${name}" >> $GITHUB_ENV
+      version=`cat debian/changelog | head -1 | grep -Poe "[^\(]*(?=\))"`
+      echo "version=${version}" >> $GITHUB_ENV
+   #this is locally: throw new Error("Parameter token or opts.auth is required");
+   - uses: dsaltares/fetch-gh-release-asset@master
+     with:
+       file: ${{ env.name }}_${{ env.version }}_i386.deb
+       target: ${{ env.name }}.deb
+       token: ${{ secrets.PAT }}
+       #repo: 'colin-i/test'
+   #Runs a set of commands using the runners shell
+   - name: Run a multi-line script
+     run: |
       #get deb
-      if [ "${{ github.event.inputs.unpublished }}" = "" ]; then
-       echo published
-       dist=`cat debian/changelog | head -1 | grep -Poe "[^ ]*(?=;)"`
-       src=ppa.launchpadcontent.net/colin-i/ppa${{ github.event.inputs.ppa }}
-       wget http://${src}/ubuntu/dists/${dist}/main/binary-i386/Packages.xz
-       xz -d Packages.xz
-       debfilename=`grep "^Filename.*/${name}_" Packages | tail -1 | cut -d ' ' -f 2`
-       wget http://${src}/ubuntu/${debfilename} -O ${name}.deb
-      else
-       echo unpublished
-       version=`cat debian/changelog | head -1 | grep -Poe "[^\(]*(?=\))"`
-       arh=`cat debian/control | grep ^Architecture | cut -d ' ' -f2`
-       if [ ! -e "lp2.py" ]; then
-        wget -q https://raw.githubusercontent.com/colin-i/test/master/lp2.py
-        #on focal is already, python3-launchpadlib is already the newest version
-        #sudo apt install python3-launchpadlib
-       fi
-       OUTPUT=$(python3 lp2.py ppa${{ github.event.inputs.ppa }} ${name} ${version} ${arh})
-       wget ${OUTPUT}/+files/${name}_${version}_${arh}.deb -O ${name}.deb
-       #f=`wget -q https://launchpad.net/~colin-i/+archive/ubuntu/ppa${{ github.event.inputs.ppa }}/+build/${{ github.event.inputs.unpublished }} -O - | grep -Poe "[^\"]*(?=\.deb\")"`
-       #wget ${f}.deb -O ${name}.deb
-      fi
+      #if [ "${{ github.event.inputs.unpublished }}" = "" ]; then
+      # echo published
+      # dist=`cat debian/changelog | head -1 | grep -Poe "[^ ]*(?=;)"`
+      # src=ppa.launchpadcontent.net/colin-i/ppa${{ github.event.inputs.ppa }}
+      # wget http://${src}/ubuntu/dists/${dist}/main/binary-i386/Packages.xz
+      # xz -d Packages.xz
+      # debfilename=`grep "^Filename.*/${name}_" Packages | tail -1 | cut -d ' ' -f 2`
+      # wget http://${src}/ubuntu/${debfilename} -O ${name}.deb
+      #else
+      # echo unpublished
+      # version=`cat debian/changelog | head -1 | grep -Poe "[^\(]*(?=\))"`
+      # arh=`cat debian/control | grep ^Architecture | cut -d ' ' -f2`
+      # if [ ! -e "lp2.py" ]; then
+      #  wget -q https://raw.githubusercontent.com/colin-i/test/master/lp2.py
+      #  #on focal is already, python3-launchpadlib is already the newest version
+      #  #sudo apt install python3-launchpadlib
+      # fi
+      # OUTPUT=$(python3 lp2.py ppa${{ github.event.inputs.ppa }} ${name} ${version} ${arh})
+      # wget ${OUTPUT}/+files/${name}_${version}_${arh}.deb -O ${name}.deb
+      # #f=`wget -q https://launchpad.net/~colin-i/+archive/ubuntu/ppa${{ github.event.inputs.ppa }}/+build/${{ github.event.inputs.unpublished }} -O - | grep -Poe "[^\"]*(?=\.deb\")"`
+      # #wget ${f}.deb -O ${name}.deb
+      #fi
       #make rpm
       mkdir out
       cd out
       sudo apt update
       sudo apt install alien
-      sudo alien -rk ../${name}.deb
+      sudo alien -rk ../${{ env.name }}.deb
       fname=`ls`
       mv ${fname} ../${fname}
       echo "file=${fname}" >> $GITHUB_ENV
--- /dev/null
+++ ovideo-1/.github/workflows/updeb.yml
@@ -0,0 +1,24 @@
+
+on:
+ workflow_dispatch:
+
+jobs:
+ udbuild:
+  runs-on: ubuntu-18.04
+  steps:
+   - name: Run a multi-line script
+     run: |
+      if [ -n "${{ env.init }}" ]; then
+       exit 1
+      fi
+      wget https://github.com/colin-i/test/releases/download/1.5/${{ env.proj }} -O 1.txt
+      echo "up_url=`cat 1.txt`" >> $GITHUB_ENV
+   - name: Upload Release Asset
+     uses: actions/upload-release-asset@v1
+     env:
+      GITHUB_TOKEN: ${{ secrets.PAT }}
+     with:
+      upload_url: ${{ env.up_url }}
+      asset_path: ./${{ env.file }}
+      asset_name: ${{ env.file }}
+      asset_content_type: application/vnd.debian.binary-package
--- ovideo-1.orig/arh/pub
+++ ovideo-1/arh/pub
@@ -1,7 +1,7 @@
 
 #1 msg  optional 2 dist
 
-tars="focal jammy mantic" #more at src/md
+tars="focal jammy" #more at src/md
 
 last=$(curl https://api.github.com/repos/colin-i/$(cat debian/control | grep "^Homepage" | grep -o [^/]*$)/releases/latest -s | jq .tag_name -r) && \
 ~/test/xver ./version.txt && \
@@ -11,6 +11,12 @@ use_version_txt=1 ~/test/debinit2 "${1}"
 #sudo gh act -r -j debuild workflow_dispatch -W .github/workflows/debuild.yml -P ubuntu-18.04=ubuntu:bionic  #ubuntu:lucid is the first one
 ~/test/deb && \
 ~/test/publp && \
+#
+~/test/debuild2 x && \
+git restore debian/files && \
+#git restore? to do at debinit push something
+~/test/updeb && \
+#
 ~/test/ai && \
 ~/test/rpm && \
 ~/test/del && \
--- ovideo-1.orig/soundrecorder/src/Makefile
+++ ovideo-1/soundrecorder/src/Makefile
@@ -23,7 +23,6 @@ all: ${wprojname}
 
 ${wprojname}: ${objname}
 	ounused ${logname}
-	@echo
 	i686-w64-mingw32-ld ${linkerflags} ${objname} -o ${wprojname} -entry record \
 		 -lmsvcrt -lkernel32 -lwinmm -luser32
 
--- ovideo-1.orig/src/Makefile
+++ ovideo-1/src/Makefile
@@ -3,6 +3,10 @@ ifndef OCOMP
 OCOMP=o
 endif
 
+ifndef OLINK
+OLINK=ounused
+endif
+
 ifndef platform
 platform=lin
 endif
@@ -67,8 +71,7 @@ sharefolder=$(DESTDIR)${sharefolderpacka
 dynlink=/lib/ld-linux.so.2
 all: ${lprojname}
 ${lprojname}: ${lshare} ${obs}
-	ounused ${logs}
-	@echo
+	${OLINK} ${logs}
 	export PKG_CONFIG_PATH=/usr/lib/i386-linux-gnu/pkgconfig/:${PKG_CONFIG_PATH}; \
 	$(LD) ${linkerflags} -melf_i386 --dynamic-linker=${dynlink} ${obs} -o ${lprojname} -lc -lm `pkg-config --libs gtk+-2.0 gstreamer-pbutils-1.0 gstreamer-app-1.0` -ljpeg -lsoup-2.4 -lasound -lgthread-2.0 -lpthread;
 ${lshare}:
@@ -81,7 +84,6 @@ wprojname=${projname}.exe
 all: ${wprojname}
 ${wprojname}: ${obs}
 	ounused ${logs}
-	@echo
 	#this is also working
 	#i686-w64-mingw32-gcc -Wl,--large-address-aware ${linkerflags} ${obs} -o ${wprojname} -Wl,--start-group \
 	#-Wl,--end-group
--- ovideo-1.orig/src/_dif/difl.oc
+++ ovideo-1/src/_dif/difl.oc
@@ -9,9 +9,9 @@ if bool!=(FALSE)
 	import "move_to_share_core" move_to_share_core
 	ss testfile="regforkoff"
 	call move_to_share_core(#testfile)
-	sd is
-	setcall is access(testfile,(F_OK))
-	if is=-1
+	datax int#1
+	setcall int access(testfile,(F_OK))
+	if int=-1
 		call gst_init(0,(NULL))
 	else
 		#this is because fedora will wrong all plugin cache on 64 for 32
--- ovideo-1.orig/src/_dif/dif~lin.oc
+++ ovideo-1/src/_dif/dif~lin.oc
@@ -820,8 +820,9 @@ function uninit_start()
 	sd er
 	setcall er home_folder(#f,(NULL))
 	if er=(noerror)
-		sd a;setcall a access(f,(F_OK))
-		if a=0
+		datax int#1
+		setcall int access(f,(F_OK))
+		if int=0
 			setcall er move_to_folder(f)
 		else
 			return (error)
--- ovideo-1.orig/src/_exec/init.oc
+++ ovideo-1/src/_exec/init.oc
@@ -116,12 +116,12 @@ endfunction
 
 #er
 function init_dir(sd f)
-	sd is
-	setcall is access(f,(F_OK))
+	datax int#1
+	setcall int access(f,(F_OK))
 	#this looks useless check but we want mkdir to return success, then, it is ok, ignoring mkdir by others between these calls
-	if is=-1
-		setcall is mkdir(f,(flag_dmode))
-		if is!=0
+	if int=-1
+		setcall int mkdir(f,(flag_dmode))
+		if int!=0
 			return "mkdir error"
 		endif
 	endif
@@ -131,10 +131,10 @@ endfunction
 function init_sys_file(sd f,sd data,sd sz,sv perr,sv forward)
 	char buf#biggest_string+1+4+1
 	call sprintf(#buf,"%s.data",f)
-	sd is
-	setcall is access(#buf,(F_OK))
+	datax int#1
+	setcall int access(#buf,(F_OK))
 	if forward=(NULL)
-		if is=-1
+		if int=-1
 			#open
 			const O_WRONLY=0x0001
 			sd fd
@@ -149,7 +149,7 @@ function init_sys_file(sd f,sd data,sd s
 			endif
 		endif
 	else
-		if is=0
+		if int=0
 			call forward(#buf)
 		endif
 	endelse
@@ -158,10 +158,10 @@ endfunction
 
 #d
 function uninit_folder(sv fn)
-	sd d;sd a
+	sd d;datax int#1
 	setcall d fn()
-	setcall a access(d,(F_OK))
-	if a=0
+	setcall int access(d,(F_OK))
+	if int=0
 		return d
 	endif
 	return (NULL)
--- ovideo-1.orig/version.txt
+++ ovideo-1/version.txt
@@ -1 +1 @@
-1.189
\ No newline at end of file
+1.191
\ No newline at end of file
